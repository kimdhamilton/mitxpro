{% load static humanize wagtailcore_tags wagtailimages_tags %}
<div class="catalog-card" role="region" aria-label="{{ courseware_page.title }}">
    <div class="top">
        <div class="cover-image">
            <div class="cover-image-frame">
                {% if courseware_page.thumbnail_image %}
                    {% image courseware_page.thumbnail_image fill-335x203 %}
                {% else %}
                    <img src="{% static default_image_path %}" alt="Preview image">
                {% endif %}
            </div>
        </div>
        <div class="top-level-details">
            <h3 class="title">
                {% if object_type == "course" %}
                    <a href="{% pageurl courseware_page %}">
                        {{ courseware_page.title }}
                    </a>
                {% else %}
                    {{ courseware_page.title }}
                {% endif %}
            </h3>
            <ul>
                {% if courseware_page.product.current_price %}
                    <li>
                        <strong>Cost:</strong>
                        ${{ courseware_page.product.current_price|floatformat:"0"|intcomma }}
                    </li>
                {% endif %}
                {% if object_type == "program" %}
                    <li>
                        <strong>Number of Courses:</strong>
                        {{ courseware_page.product.courses.count }}
                    </li>
                {% endif %}
                {% if courseware_page.duration %}
                    <li>
                        <strong>Duration:</strong>
                        {{ courseware_page.duration }}
                    </li>
                {% endif %}
                {% if courseware_page.product.next_run_date %}
                    <li>
                        <strong>Next Start Date:</strong>
                        {{ courseware_page.product.next_run_date|date:"F j, Y" }}
                    </li>
                {% endif %}
            </ul>
        </div>
        <div class="offering-type">
            <label>
                {% if object_type == "course" %}
                    Single
                {% else %}
                    Multi
                {% endif %}
                Course Online
            </label>
        </div>
    </div>
    <div class="bottom">
        <div class="collapsible-menu">
            <div class="wrap-collapsible">
            {% if tab == "all" %}
                <input id="collapsible_{{ object_type }}{{ courseware_page.pk }}" class="toggle" type="checkbox" />
                <label for="collapsible_{{ object_type }}{{ courseware_page.pk }}" class="lbl-toggle">
                    Details
                </label>
            {% else %}
                <input id="collapsible_filter_{{ object_type }}{{ courseware_page.pk }}" class="toggle" type="checkbox" />
                <label for="collapsible_filter_{{ object_type }}{{ courseware_page.pk }}" class="lbl-toggle">
                    Details
                </label>
            {%  endif %}
                <div class="collapsible-content">
                    <div class="content-inner">
                        <div class="details-body">
                            {% if courseware_page.description %}
                                <div class="description">{{ courseware_page.description|richtext }}</div>
                            {% endif %}
                            {% if object_type == "program" %}
                                <ul class="program-course-links">
                                    {% for course_page in program.page.course_pages %}
                                        <li>
                                            <a href="{% pageurl course_page %}" target="_blank">
                                                {{ course_page.title }}
                                            </a>
                                        </li>
                                    {% endfor %}
                                </ul>
{#                              TODO Need to make it functional#}
                                <a href="{% pageurl courseware_page %}" class="link-button">
                                    View Program
                                </a>
                            {% endif %}
                            {% if object_type == "course" %}
                                <a href="{% pageurl courseware_page %}" target="_blank" class="link-button">
                                    View Course
                                </a>
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
